{% extends "movies/base.html" %}
{% block content %}
<h1>ðŸŽ¬ WhichMovie - Movie Database</h1>

<div style="margin-bottom: 30px; padding: 15px; background-color: #f5f5f5; border-radius: 8px;">
  <p><strong>Total Movies:</strong> {{ total_movies }}</p>
  <p><strong>Enriched with TMDB:</strong> {{ enriched_movies }} / {{ total_movies }}</p>
</div>

{% if movies %}
  <div style="display: grid; grid-template-columns: repeat(auto-fill, minmax(250px, 1fr)); gap: 20px;">
    {% for movie in movies %}
      <div style="border: 1px solid #ddd; border-radius: 8px; padding: 15px; background-color: #fff; box-shadow: 0 2px 4px rgba(0,0,0,0.1);">
        <!-- Poster Image -->
        {% if movie.poster_path %}
          <img src="https://image.tmdb.org/t/p/w342{{ movie.poster_path }}" alt="{{ movie.title }}" style="width: 100%; border-radius: 4px; margin-bottom: 10px; max-height: 300px; object-fit: cover;">
        {% else %}
          <div style="width: 100%; height: 200px; background-color: #e0e0e0; border-radius: 4px; margin-bottom: 10px; display: flex; align-items: center; justify-content: center; color: #999;">
            No Poster
          </div>
        {% endif %}

        <!-- Title -->
        <h3 style="margin: 10px 0; font-size: 18px;">{{ movie.title }}</h3>

        <!-- Source & TMDB ID -->
        <p style="margin: 5px 0; font-size: 12px; color: #666;">
          <strong>Source:</strong> {{ movie.source }}
          {% if movie.tmdb_id %}
            | <strong>TMDB ID:</strong> {{ movie.tmdb_id }}
          {% endif %}
        </p>

        <!-- Release Date -->
        {% if movie.release_date %}
          <p style="margin: 5px 0; font-size: 12px; color: #666;">
            <strong>Released:</strong> {{ movie.release_date|date:"Y-m-d" }}
          </p>
        {% endif %}

        <!-- Overview -->
        {% if movie.overview %}
          <p style="margin: 10px 0; font-size: 13px; color: #333; line-height: 1.4;">
            {{ movie.overview|truncatewords:30 }}
          </p>
        {% endif %}

        <!-- Video ID (YouTube) -->
        {% if movie.video_id %}
          <p style="margin: 10px 0;">
            <a href="https://www.youtube.com/watch?v={{ movie.video_id }}" target="_blank" style="color: #e74c3c; text-decoration: none; font-weight: bold;">
              Watch on YouTube â†’
            </a>
          </p>
        {% endif %}

        <!-- IMDb Link -->
        {% if movie.imdb_id %}
          <p style="margin: 10px 0;">
            <a href="https://www.imdb.com/title/{{ movie.imdb_id }}" target="_blank" style="color: #f1c40f; text-decoration: none; font-weight: bold;">
              View on IMDb â†’
            </a>
          </p>
        {% endif %}

        <!-- Created Date -->
        <p style="margin: 10px 0; font-size: 11px; color: #999;">
          Added: {{ movie.created_at|date:"Y-m-d H:i" }}
        </p>
      </div>
    {% endfor %}
  </div>
{% else %}
  <p style="text-align: center; color: #999; font-size: 18px;">No movies found. Run the YouTube fetch task to populate the database.</p>
{% endif %}

<style>
  body {
    font-family: Arial, sans-serif;
    background-color: #fafafa;
    padding: 20px;
  }
  h1 {
    color: #2c3e50;
    margin-bottom: 20px;
  }
</style>
{% endblock %}